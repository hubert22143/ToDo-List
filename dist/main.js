(()=>{"use strict";function e(){const e=new Uint32Array(2);window.crypto.getRandomValues(e);const t=e[0]*Math.pow(2,32)+e[1];return`${Date.now()}${t}`}class t{constructor(t){this.name=t,this.tasks=[],this.id=e()}}class n{static projects=[];static createProject(e){const o=new t(e);return n.projects.push(o),o}static deleteProject(e){const t=n.projects.findIndex((t=>t.name===e));-1!==t&&n.projects.splice(t,1)}static showArray(){console.log(n.projects)}static addTask(e,t){e.tasks.push(t)}static removeTask(e){for(const t of n.projects){const n=t.tasks.findIndex((t=>t.taskId===e));-1!==n&&t.tasks.splice(n,1)}}}const o=document.querySelector(".errorContainer"),a=document.getElementById("errorButtonStyles"),c=document.querySelector(".CreateProjectContainer");function d(){o.style.display="block",c.style.display="none",a.addEventListener("click",(e=>{e.preventDefault(),o.style.display="none"}))}const s=document.querySelector(".successufullNotificationContainer"),l=document.getElementById("closeButton");function r(){s.style.display="flex",setTimeout((()=>{s.style.display="none"}),5e3),l.addEventListener("click",(()=>{s.style.display="none",console.log("click")}))}function i(e){const t=document.querySelector(".todayPage"),n=document.createElement("table"),o=document.createElement("thead"),a=document.createElement("tr");["ID","Title","Description","startDate","startHour","endDate","endHour","taskPriority"].forEach((e=>{const t=document.createElement("th");t.appendChild(document.createTextNode(e)),a.appendChild(t)})),o.appendChild(a),n.appendChild(o);const c=document.createElement("tbody");(Array.isArray(e)?e:[e]).forEach(((e,t)=>{const n=document.createElement("tr"),o=document.createElement("td");o.appendChild(document.createTextNode(t)),n.appendChild(o);const a=document.createElement("td");a.appendChild(document.createTextNode(e.title)),n.appendChild(a);const d=document.createElement("td");d.appendChild(document.createTextNode(e.description)),n.appendChild(d);const s=document.createElement("td");s.appendChild(document.createTextNode(e.startDate)),n.appendChild(s);const l=document.createElement("td");l.appendChild(document.createTextNode(e.startHour)),n.appendChild(l);const r=document.createElement("td");r.appendChild(document.createTextNode(e.endDate)),n.appendChild(r);const i=document.createElement("td");i.appendChild(document.createTextNode(e.endHour)),n.appendChild(i);const u=document.createElement("td");u.appendChild(document.createTextNode(e.priority)),n.appendChild(u),c.appendChild(n)})),n.appendChild(c),t.appendChild(n)}function u(){document.querySelectorAll(".default").forEach((e=>{e.addEventListener("click",(e=>{"Default Project"===e.target.textContent&&m()}))}))}function m(){let e=n.projects,t=e.find((e=>"Default Project"===e.name));if(t){let e=t.tasks;p(),i(e)}else console.error("Default Project not found"),console.log(e)}function p(){document.querySelector(".todayPage").innerHTML=""}function h(e){var t;e&&(t=e.id,document.querySelector(`[data-project-id="${t}"]`)||(function(e){const t=document.querySelector(".listOfProjects"),n=document.createElement("div");n.setAttribute("data-project-id",e.id),n.classList.add("default");const o=document.createElement("img");o.src="images/hashtag.png",o.classList.add("stylizedImg");const a=document.createElement("span");a.textContent=e.name,n.appendChild(o),n.appendChild(a),t.appendChild(n),function(e){const t=document.querySelector(".todayPage");e.addEventListener("click",(()=>{t.innerHTML="",u()}))}(n)}(e),y()),y())}function y(){const e=document.getElementById("availableProjects");e.innerHTML="";const t=new Set;n.projects.forEach((e=>{t.add(e.name)})),t.forEach((t=>{const n=document.createElement("option");n.value=t,n.textContent=t,e.appendChild(n)}))}class E{constructor(){this.createProjectImage=document.getElementById("CreateProject"),this.createProjectSubmit=document.getElementById("CreateProjectSubmit"),this.submitButtonProjectValue=document.getElementById("ProjectNameHolder"),this.createProjectContainer=document.querySelector(".CreateProjectContainer"),this.createProjectCancel=document.getElementById("CreateProjectCancel")}handleProjectOpen(){this.createProjectImage.addEventListener("click",(()=>{this.createProjectContainer.style.display="flex"}))}handleProjectCreate(){if(""!==this.submitButtonProjectValue.value){const e=/\d/.test(this.submitButtonProjectValue.value);if(this.submitButtonProjectValue.value.length>=3&&!e){const e=n.createProject(this.submitButtonProjectValue.value);e?(this.createProjectContainer.style.display="none",h(e),r()):d()}else d()}}handleButtonSubmit(){this.createProjectSubmit.addEventListener("click",(e=>{e.preventDefault(),this.handleProjectCreate(),n.showArray()}))}handleProjectCancel(){this.createProjectCancel.addEventListener("click",(()=>{this.createProjectContainer.style.display="none"}))}}class k{constructor(t,n,o,a,c,d,s){this.title=t,this.description=n.length>20?n.slice(0,20):n,this.startDate=o,this.startHour=a,this.endDate=c,this.endHour=d,this.priority=s,this.taskId=e(),k.allTasks.push(this)}static allTasks=[];static createTask(e,t,n,o,a,c,d,s){return new k(e,t,n,o,a,c,d,s)}static removeTask(e){const t=k.allTasks.findIndex((t=>t.taskId===e));-1!==t?k.allTasks.splice(t,1):console.log("Task not found in the array")}}class g{constructor(){this.title=document.getElementById("TaskNameHolder").value,this.description=document.getElementById("TaskTextArea").value,this.startDate=document.getElementById("TaskDateStart").value,this.startHour=document.getElementById("TaskHourStart").value,this.endDate=document.getElementById("TaskDateEnd").value,this.endHour=document.getElementById("TaskHourEnd").value,this.taskPriority=document.getElementById("taskPriority").value,this.selectedProjectName=document.getElementById("availableProjects").value}assignValuesToProject(){const e=k.createTask(this.title,this.description,this.startDate,this.startHour,this.endDate,this.endHour,this.taskPriority);console.log(e);const t=n.projects.find((e=>e.name===this.selectedProjectName));console.log(t),t?(n.addTask(t,e),n.showArray()):console.log("Some ugly error occured")}}function C(e){if("Default Project"!==e){let t=n.projects;console.log(t);let o=t.find((t=>t.name===e));o?i(o.tasks):console.log("Current project not found")}else m()}class f{constructor(){this.createTaskImage=document.getElementById("createTask"),this.createTaskSubmit=document.getElementById("CreateTaskSubmit"),this.submitButtonTaskValue=document.getElementById("TaskNameHolder"),this.createTaskContainer=document.querySelector(".CreateTaskContainer"),this.createTaskCancel=document.getElementById("CreateTaskCancel"),this.defaultProjectName="Default Project",this.availableProjectsSelect=document.getElementById("availableProjects")}handleTaskOpen(){this.createTaskImage.addEventListener("click",(()=>{this.createTaskContainer.style.display="flex",s.style.display="none"}))}taskButtonSubmit(){this.createTaskSubmit.addEventListener("click",(e=>{e.preventDefault(),console.log(this.submitButtonTaskValue.value),this.createTaskContainer.style.display="none",(new g).assignValuesToProject(),r(),this.defaultProjectName===this.availableProjectsSelect.value?m():document.querySelectorAll(".default").forEach((e=>{const t=e.querySelector("span").textContent;console.log(t),p(),C(t),e.addEventListener("click",(()=>{p(),C(t)}))}))}))}handleTaskCancel(){this.createTaskCancel.addEventListener("click",(()=>{this.createTaskContainer.style.display="none"}))}}const j="projects";function v(){const e=n.projects.map((e=>({id:e.id,name:e.name,tasks:e.tasks})));window.localStorage.setItem(j,JSON.stringify(e))}function P(){const e=JSON.parse(localStorage.getItem(j))||[];return n.projects=e.map((e=>{const n=new t(e.name);return n.id=e.id,n.tasks=e.tasks,h(n),n})),n.projects}function T(e,t){document.getElementById("editSubmit").addEventListener("click",(()=>{const n=document.getElementById("editTitle").value,o=document.getElementById("editDescription").value,a=document.getElementById("editStartDate").value,c=document.getElementById("editStartHour").value,d=document.getElementById("editEndDate").value,s=document.getElementById("editEndHour").value,l=document.getElementById("editPriority").value;e.taskId===t&&(e.title=n,e.description=o,e.startDate=a,e.startHour=c,e.endDate=d,e.endHour=s,e.priority=l),document.querySelector(".showEditContainer").style.display="none"}))}function S(e){document.getElementById("editTitle").value=e.title,document.getElementById("editDescription").value=e.description||"",document.getElementById("editStartDate").value=e.startDate||"",document.getElementById("editStartHour").value=e.startHour||"",document.getElementById("editEndDate").value=e.endDate||"",document.getElementById("editEndHour").value=e.endHour||"";const t=document.getElementById("editPriority");t.innerHTML="",["Small","Medium","High"].forEach((e=>{const n=document.createElement("option");n.value=e,n.text=e,t.appendChild(n)}))}function I(){let e=document.querySelectorAll(".checkProject");e&&e.forEach((e=>{e.addEventListener("click",(()=>{const t=e.closest(".myDynamicallyCreatedProject");e.checked?(console.log("The checkbox has been checked now"),function(e){let t=e.querySelector(".seperatedProjectOutput");if(t&&!t.querySelector("#trashContainer")){let o=document.createElement("div");o.classList.add("CreatedAutomaticallyCheckbox"),o.style.display="flex",o.style.flexDirection="column";let a=document.createElement("img");a.src="images/trash.png",a.classList.add("stylizedImg"),a.id="trashContainer",a.style.marginBottom="10px",a.addEventListener("click",(()=>{!function(e){const t=document.getElementById(e);t?(t.remove(),k.removeTask(e),n.removeTask(e),B()):console.log("Task container not found")}(e.getAttribute("id"))}));let c=document.createElement("img");c.src="images/edit.png",c.classList.add("stylizedImg"),c.id="editContainer",c.style.marginBottom="10px",c.addEventListener("click",(t=>{const o=e.getAttribute("id");console.log(o),function(e){const t=n.projects;console.log(e);for(const n of t){const t=n.tasks.find((t=>t.taskId===e));t&&(S(t),T(t,e))}}(o),document.querySelector(".showEditContainer").style.display="block",function(){const e=document.getElementById("editCancel"),t=document.querySelector(".showEditContainer");e.addEventListener("click",(()=>{t.style.display="none"}))}()})),o.appendChild(a),o.appendChild(c),t.appendChild(o)}else console.error("Parent container not found.")}(t),function(e){e.querySelector(".tittleOutput").style.display="none",e.querySelector(".hourOutput").style.display="none",e.querySelector(".adherenceToProject").style.display="none"}(t)):(console.log("The checkbox has been unchecked"),function(e){let t=e.querySelector(".CreatedAutomaticallyCheckbox");t&&t.remove()}(t),function(e){e.querySelector(".tittleOutput").style.display="flex",e.querySelector(".hourOutput").style.display="flex",e.querySelector(".adherenceToProject").style.display="flex"}(t))}))}))}function B(){let e=document.querySelector(".todayPage").innerHTML;document.querySelector(".dailyTasks").addEventListener("click",(()=>{document.querySelector(".todayPage").innerHTML=e,I()}))}function D(){n.projects.forEach((e=>{let t=e.tasks;if(t.length>0){let n=t.some((e=>void 0!==e.endDate));n?t.forEach((t=>{let n=t.title,o=t.startDate,a=t.startHour,c=t.endHour,d=t.endDate,s=e.name,l=t.taskId;var r;r=l,document.getElementById(r)||(function(e,t,n,o,a,c,d){let s=document.querySelector(".myProjects");null===s&&console.log("Hehe"),console.log(s);let l=document.createElement("div");l.classList.add("myDynamicallyCreatedProject"),l.id=`${d}`;let r=document.createElement("hr"),i=document.createElement("div");i.classList.add("dynamicallyCreatedProject1");let u=document.createElement("div");u.classList.add("checkBoxStylize");let m=document.createElement("input");m.type="checkbox",m.classList.add("checkProject"),u.appendChild(m);let p=document.createElement("div");p.classList.add("orangeLineSeperator");let h=document.createElement("div");h.classList.add("seperatedTittleOutput");let y=document.createElement("div");y.classList.add("tittleOutput"),y.textContent=`${e}`;let E=document.createElement("div");E.classList.add("hourOutput"),E.textContent=`Your task start at ${t} ${n}, and end at ${o} ${a} `,h.appendChild(y),h.appendChild(E);let k=document.createElement("div");k.classList.add("seperatedProjectOutput");let g=document.createElement("b");g.classList.add("adherenceToProject"),g.textContent=`${c}`,k.appendChild(g),i.appendChild(u),i.appendChild(p),i.appendChild(h),i.appendChild(k),l.appendChild(r),l.appendChild(i),s.appendChild(l)}(n,a,o,c,d,s,l),I()),B()})):console.log("It doesn't have an end date, nothing happens")}}))}const L=document.querySelector(".todayPage");document.addEventListener("DOMContentLoaded",(()=>{!function(){const e=new E;e.handleProjectOpen(),e.handleButtonSubmit(),e.handleProjectCancel()}(),function(){const e=new f;e.handleTaskOpen(),e.taskButtonSubmit(),e.handleTaskCancel()}(),function(e){const t=P().some((e=>"Default Project"===e.name)),o=n.createProject(e);if(!t&&e){console.log("Created default project:",o,n.projects);const e=k.createTask("Default Task","Default description","2024-01-15","12:00","2024-01-16","14:00","Medium");n.addTask(o,e),v()}}("Default Project"),B(),D(),u(),L.addEventListener("click",(e=>{"refreshButton"===e.target.id&&D()})),P()})),window.addEventListener("beforeunload",v)})();